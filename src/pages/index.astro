---
import "../styles/global.css";
---
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Versefy</title>

    <!-- Google Font -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap"
      rel="stylesheet"
    />
  </head>

  <body
    class="min-h-screen m-0 font-['Poppins',system-ui]
           text-white/90 overflow-hidden
           bg-gradient-to-br from-slate-900 to-slate-950"
  >

    <!-- Partículas -->
    <canvas
      id="particles"
      class="fixed inset-0 z-0 pointer-events-none"
    ></canvas>

    <!-- Center card -->
    <main class="relative z-10 flex min-h-screen items-center justify-center">
      <article class="text-center animate-floatIn px-12">

        <!-- Loading -->
        <div
          id="loading"
          class="animate-pulse text-xl tracking-wide font-light"
        >
          Generando Mensaje ⏳✨
        </div>

        <!-- Versículo -->
        <div
          id="verse-container"
          class="hidden opacity-0 transition-opacity duration-700 animate-floatIn"
        >
          <h1
            id="verse-text"
            style="font-weight:300;font-size:clamp(20px,3.6vw,36px)"
          ></h1>
          <p
            id="verse-ref"
            style="opacity:.9;font-weight:600"
          ></p>
        </div>

      </article>
    </main>

    <!-- Footer -->
    <footer
      class="fixed right-4 bottom-4 z-20
             flex items-center gap-3"
    >
      <img
        src="/images/noche_juvenil.svg"
        alt="Icono"
        class="h-6 w-auto opacity-80"
      />
      <img
        src="/images/logo_fjc.png"
        alt="Logo"
        class="h-5 w-auto opacity-80"
      />
    </footer>

    <!-- Versos -->
    <script>
      async function cargarVersos() {
        const loading = document.getElementById('loading');
        const verseContainer = document.getElementById('verse-container');

        // Loading de 2 segundos
        await new Promise(resolve => setTimeout(resolve, 3500));

        const res = await fetch('/data/verses.json');
        const verses = await res.json();

        const i = Math.floor(Math.random() * verses.length);
        const v = verses[i];

        document.getElementById('verse-text').textContent = v.text;
        document.getElementById('verse-ref').textContent  = v.ref;

        // Mostrar versículo
        loading.classList.add('hidden');
        verseContainer.classList.remove('hidden');

        requestAnimationFrame(() => {
          verseContainer.classList.remove('opacity-0');
        });
      }

      document.addEventListener('DOMContentLoaded', cargarVersos);
      
    </script>

    <!-- Partículas -->
    <script>
      const canvas = document.getElementById("particles");
      const ctx = canvas.getContext("2d");

      let particles = [];
      const count = 60;

      function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }

      window.addEventListener("resize", resize);
      resize();

      function createParticles() {
        particles = Array.from({ length: count }, () => ({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height,
          r: Math.random() * 1.8 + 0.5,
          vx: (Math.random() - 0.5) * 0.3,
          vy: (Math.random() - 0.5) * 0.3,
          a: Math.random() * 0.5 + 0.3
        }));
      }

      function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        for (const p of particles) {
          ctx.beginPath();
          ctx.fillStyle = `rgba(255,255,255,${p.a})`;
          ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
          ctx.fill();

          p.x += p.vx;
          p.y += p.vy;

          if (p.x < 0 || p.x > canvas.width) p.vx *= -1;
          if (p.y < 0 || p.y > canvas.height) p.vy *= -1;
        }

        requestAnimationFrame(draw);
      }

      createParticles();
      draw();
    </script>

  </body>
</html>
